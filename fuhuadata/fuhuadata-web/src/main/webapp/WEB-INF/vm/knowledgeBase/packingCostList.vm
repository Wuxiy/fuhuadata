<div class="nav-deputy shadow-out clearfix">
    <ul class="breadcrumb pull-right">
        <li><span class="glyphicon glyphicon-map-marker"></span></li>
    </ul>
</div>

<div class="dashboard-wrapper">
    <div class="row">
        <!--树形导航开始-->
        <div class="col-xs-2">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title" lang="zh">
                        包材分类
                    </h3>
                </div>
                <div class="panel-body clearfix">
                    <!--树形菜单-->
                    <div id="tree" class="tree"></div>
                </div>
            </div>
        </div>
         <!--列表部分-->
        <div class="col-xs-10">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <button class="btn btn-xs btn-primary pull-right panel-heading-btn" data_url="${request.contextPath}/packingArchives/addPackingArchives?" onclick="Add()" id="add">
                    <span class="glyphicon glyphicon-plus"></span>
                    新增
                </button>
                    <h3 class="panel-title" lang="zh">
                        包材成本参考
                    </h3>
                </div>
                <div class="panel-body clearfix">
                    <table class="table table-condensed table-bordered table-striped text-center">
                        <thead>
                        <tr>
                            <th class="text-center" lang="zh">编号</th>
                            <th class="text-center" lang="zh">包材类型名称</th>
                            <th class="text-center" lang="zh">规格</th>
                            <th class="text-center" lang="zh">材质</th>
                            <th class="text-center" lang="zh">质量指标</th>
                            <th class="text-center" lang="zh">质量指标数值</th>
                            <th class="text-center" lang="zh">单价（元）</th>
                            <th class="text-center" lang="zh">价格有效期</th>
                            <th class="text-center" lang="zh">适用剂型</th>
                            <th class="text-center" lang="zh">备注</th>
                            <th class="text-center" lang="zh">状态</th>
                        </tr>
                        </thead>
                        <tbody id="container">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" language="javascript" src="${request.contextPath}/lib/js/scaffolding.js"></script>
<script type="text/javascript" language="javascript" src="${request.contextPath}/lib/js/creatTree.js"></script>
<script type="text/javascript">
    $(function(){
        $('#tree').creatTree('${request.contextPath}/packingCategory/CategoryTree');
        $('#tree').filtrateData('${request.contextPath}/packingArchives/getPackingArchivesByPId',"container","packingArchivesList");
        jQuery.ajax({
            url:'/packingArchives/getPackingArchivesByPId',
            type:'POST',
            data:{id:1}
        }).done(packingArchivesList);
    })

    function Add(){
        var names = $('.packName');
        var name = 'name=' + names[0].innerText;
        var bids = names[0].href;
        console.log(bids);
        var bid = bids.split('&')[1];
        var sid = bids.split('&')[2];
        var data_url = $('#add').attr('data_url');
        var url = data_url + name + '&' + bid + '&' + sid;
        console.log(url);
        window.location.href = url;

    }

    /**
     *packingArchives
     */
    function packingArchivesList(data) {
        var getData = data.data;
        jQuery.each(getData,function(n,item){
            var parent  = $('#container');
            var tr = '<tr><td>'+item.packingId+'</td><td><a href="/packingArchives/getDetails?id='+item.packingId+'&bid='+item.bigCategoryId+'&sid='+item.smallCategoryId+'" class="packName">'+item.packName+'</a></td><td>'+item.spec+'</td><td>'+item.quality+'</td><td>'+item.qualityIndex+'</td><td>'+item.qualityTargetValue+'</td><td>'+item.unitPrice+'</td><td>'+item.priceEndDate+'</td><td>'+item.suitableType+'</td><td>'+item.bRemarks+'</td><td>'+item.status+'</td></tr>';
            console.log(item);
            $(tr).appendTo(parent);
        })
    }

</script>
