<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
        "http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="EXHIBITIONINFO">
    <typeAlias alias="ExhibitionInfo" type="com.fuhuadata.domain.ExhibitionInfo"/>
    <typeAlias alias="ExhibitionInfoQuery" type="com.fuhuadata.domain.query.ExhibitionInfoQuery"/>
    <resultMap id="EXHIBITIONINFO-MAP" class="ExhibitionInfo">
        <result property="exhibitionId" column="exhibition_id" jdbcType="INT" javaType="java.lang.Integer"/>
        <result column="exhibition_name" property="exhibitionName" jdbcType="VARCHAR" javaType="java.lang.String" />
        <result column="sponsor" property="sponsor" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result column="organizer" property="organizer" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result column="region" property="region" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result column="country" property="country" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result column="city" property="city" jdbcType="VARCHAR" javaType="java.lang.String"/>
            <result column="start_date" property="startDate" jdbcType="DATE" javaType="java.sql.Date"/>
        <result column="finish_date" property="finishDate" jdbcType="DATE" javaType="java.sql.Date"/>
        <result column="exhibition_addr" property="exhibitionAddr" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result column="exhibition_link" property="exhibitionLink" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result property="exhibitionInfo" column="exhibition_info" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result column="creator" property="creator" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result column="create_time" property="createTime" jdbcType="DATE" javaType="java.sql.Date"/>
    </resultMap>
    <sql id="PAGE-COMMON">
        <dynamic prepend=" WHERE ">
            <isNotNull prepend=" AND " property="exhibitionName">
                exhibition_name like concat('%',#exhibitionName#,'%')
            </isNotNull>
            <isNotNull prepend=" AND " property="country">
                country = #country#
            </isNotNull>
            <isNotNull prepend=" AND " property="city">
                city = #city#
            </isNotNull>
            <isNotNull prepend=" AND " property="startDate">
                start_date = #startDate#
            </isNotNull>
            <isNotNull prepend=" AND " property="finishDate">
                finish_date = #finishDate#
            </isNotNull>
            <isNotNull prepend=" AND " property="searchKey">
                name like concat('%',#searchKey#,'%')
            </isNotNull>
        </dynamic>
    </sql>

    <insert id="ADD" parameterClass="ExhibitionInfo">
        insert into k_exhibition_info (exhibition_id, exhibition_name, sponsor,
        organizer, region, country,
        city, start_date, finish_date,
        exhibition_addr, exhibition_link, creator,
        create_time, exhibition_info)
        values (#exhibitionId#, #exhibitionName#, #sponsor#,
        #organizer#, #region#, #country#,
        #city#, #startDate#, #finishDate#,
        #exhibitionAddr#, #exhibitionLink#, #creator#,
        #createTime#, #exhibitionInfo#)
        <selectKey resultClass="int" keyProperty="exhibitionId">
            SELECT @@IDENTITY AS exhibition_id
        </selectKey>
    </insert>

    <update id="UPDATE" parameterClass="ExhibitionInfo">
        UPDATE k_exhibition_info
        <dynamic prepend=" SET ">
            <isNotNull prepend=", " property="exhibitionName">
                exhibition_name = #exhibitionName#
            </isNotNull>
            <isNotNull prepend=", " property="sponsor">
                sponsor = #sponsor#
            </isNotNull>
            <isNotNull prepend=", " property="organizer">
                organizer = #organizer#
            </isNotNull>
            <isNotNull prepend=", " property="region">
                region =#region#
            </isNotNull>
            <isNotNull prepend=", " property="country">
                country = #country#
            </isNotNull>
            <isNotNull prepend=", " property="city">
                city = #city#
            </isNotNull>
            <isNotNull prepend=", " property="startDate">
                start_date = #startDate#
            </isNotNull>
            <isNotNull prepend=", " property="finishDate">
                finish_date = #finishDate#
            </isNotNull>
            <isNotNull prepend=", " property="exhibitionAddr">
                exhibition_addr = #exhibitionAddr#
            </isNotNull>
            <isNotNull prepend=", " property="exhibitionLink">
                exhibition_link  = #exhibitionLink#
            </isNotNull>
            <isNotNull prepend=", " property="creator">
                creator = #creator#
            </isNotNull>
            <isNotNull prepend=", " property="createTime">
                create_time = #createTime#
            </isNotNull>
            <isNotNull prepend=", " property="exhibitionInfo">
                exhibition_info = #exhibitionInfo#
            </isNotNull>
        </dynamic>
    </update>

    <delete id="DELETE-BY-ID" parameterClass="java.lang.Integer">
        <![CDATA[
            DELETE FROM k_exhibition_info WHERE exhibition_id = #exhibitionId#
        ]]>
    </delete>

    <select id="GET-PAGE" resultMap="EXHIBITIONINFO-MAP" parameterClass="ExhibitionInfoQuery">
        <![CDATA[
        SELECT * FROM k_exhibition_info
        ]]>
        <isParameterPresent>
        <include refid="PAGE-COMMON"/>
        </isParameterPresent>
        LIMIT #startRow#,#pageSize#
    </select>

    <select id="COUNT" resultClass="java.lang.Integer" parameterClass="ExhibitionInfoQuery">
        <![CDATA[
        SELECT COUNT(*) FROM k_exhibition_info
        ]]>
        <isParameterPresent>
            <include refid="PAGE-COMMON"/>
        </isParameterPresent>
    </select>
</sqlMap>